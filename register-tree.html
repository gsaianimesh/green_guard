<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Register a New Tree | GreenGuard</title>

    <link href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3EðŸŒ±%3C/text%3E%3C/svg%3E" rel="icon" type="image/svg+xml" />
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&family=Poppins:wght@700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        // --- Tailwind Config ---
        tailwind.config = {
            darkMode: "class",
            theme: {
                 extend: {
                    colors: {
                        primary: "#06f967",
                        "gg-green-bright": "#4CAF50",
                        "gg-green-dark": "#0B1C11",
                        "gg-green-mid": "#102918",
                        "gg-green-light": "#133A21",
                        "gg-green-cta": "#1A4B2B",
                        "gg-dark-neutral": "#0E1410",
                        "background-dark": "#0B0E0C",
                    },
                    fontFamily: {
                        display: ["Inter", "sans-serif"],
                        heading: ["Poppins", "sans-serif"],
                    },
                     borderRadius: {
                        DEFAULT: "0.5rem",
                        lg: "1rem",
                        xl: "1.5rem",
                        full: "9999px"
                    },
                    boxShadow: {
                        'glow-primary': '0 0 15px 5px rgba(6, 249, 103, 0.4), 0 0 5px 2px rgba(6, 249, 103, 0.6)',
                        'glow-green': '0 0 15px 5px rgba(76, 175, 80, 0.4), 0 0 5px 2px rgba(76, 175, 80, 0.6)',
                    }
                },
            },
        };
    </script>

    <style type="text/tailwindcss">
        @layer components {
            .glassmorphic {
                @apply bg-white/5 border border-white/10 shadow-lg rounded-xl;
                -webkit-backdrop-filter: blur(10px);
                backdrop-filter: blur(10px);
            }
            .form-input-icon {
                @apply w-full rounded-lg py-3 px-4 pl-12 text-white placeholder-white/40
                       focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary
                       transition-all duration-300;
                background: rgba(255, 255, 255, 0.05);
                -webkit-backdrop-filter: blur(8px);
                backdrop-filter: blur(8px);
                border: 1px solid rgba(255, 255, 255, 0.1);
            }
             .form-input-icon:focus { border-color: #06f967; }
            .form-input-icon[type="date"] { position: relative; }
            .form-input-icon[type="date"]::-webkit-calendar-picker-indicator {
                 position: absolute; right: 0.5rem; top: 50%; transform: translateY(-50%);
                 filter: invert(1) grayscale(1) brightness(1.5) opacity(0.6);
                 cursor: pointer; padding: 0.25rem;
            }
             select.form-input-icon {
                 background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23ffffffa0' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
                 background-position: right 0.5rem center; background-repeat: no-repeat;
                 background-size: 1.5em 1.5em; padding-right: 2.5rem;
                 -webkit-appearance: none; -moz-appearance: none; appearance: none;
            }
            textarea.form-input-icon { @apply !pl-4; }
            .input-icon {
                @apply absolute left-4 top-1/2 -translate-y-1/2 text-white/40
                       group-focus-within:text-primary transition-colors duration-300;
                 pointer-events: none;
            }
            .upload-box {
                @apply w-full h-full min-h-[300px] border-2 border-dashed border-white/20 rounded-lg
                       flex flex-col items-center justify-center text-center text-white/60
                       cursor-pointer hover:bg-white/10 hover:border-primary transition-all;
            }
             .detail-label { @apply text-xs text-white/60 uppercase tracking-wider; }
            .detail-value { @apply font-medium text-white break-words; }
        }
    </style>
</head>

<body class="bg-background-dark text-white font-display antialiased">
    <div class="relative min-h-screen w-full flex flex-col overflow-x-hidden">
        <div class="absolute inset-0 z-0">
             <div class="absolute inset-0 bg-gradient-to-t from-background-dark to-gg-green-dark"></div>
        </div>

        <div class="relative z-10 flex flex-col grow items-center justify-center min-h-screen py-20 px-6">
            <div class="w-full max-w-4xl">
                <div class="glassmorphic p-8">

                    <form id="treeForm" class="grid grid-cols-1 md:grid-cols-2 gap-x-10 gap-y-6">

                        <div class="md:col-span-1 space-y-6">
                             <div class="md:text-left">
                                <h2 class="text-3xl font-bold font-heading text-white mb-2">Register a New Tree</h2>
                                <p class="text-white/70">Fields marked with <span class="text-red-500">*</span> are required.</p>
                            </div>
                            <div>
                                <label for="species" class="block text-sm font-medium text-white/80 mb-2">Species <span class="text-red-500">*</span></label>
                                <div class="relative group"><span class="material-symbols-outlined input-icon">park</span><input type="text" id="species" name="species" class="form-input-icon" placeholder="Name of the tree" required></div>
                            </div>
                            <div>
                                <label for="age" class="block text-sm font-medium text-white/80 mb-2">Approx. Age <span class="text-red-500">*</span></label>
                                <div class="relative group"><span class="material-symbols-outlined input-icon">hourglass_empty</span><select id="age" name="age" class="form-input-icon" required><option value="" disabled selected>Select age range</option><option value="<1 year (Sapling)"><1 year (Sapling)</option><option value="1-3 years">1-3 years</option><option value="3-5 years">3-5 years</option><option value="5+ years (Mature)">5+ years (Mature)</option></select></div>
                            </div>
                             <div>
                                <label for="plantingDate" class="block text-sm font-medium text-white/80 mb-2">Planting Date <span class="text-red-500">*</span></label>
                                <div class="relative group"><span class="material-symbols-outlined input-icon">calendar_month</span><input type="date" id="plantingDate" name="plantingDate" class="form-input-icon" required></div>
                            </div>
                            <div>
                                <label for="treeLocation" class="block text-sm font-medium text-white/80 mb-2">Tree Location <span class="text-red-500">*</span></label>
                                <div class="flex items-center gap-2"><div class="relative group grow"><span class="material-symbols-outlined input-icon">location_on</span><input type="text" id="treeLocation" name="treeLocation" class="form-input-icon opacity-70" placeholder="Click button ->" readonly required></div><button type="button" id="getLocationBtn" title="Get tree's precise location" class="flex-shrink-0 bg-white/10 hover:bg-white/20 text-white font-medium p-3 rounded-lg transition-colors"><span class="material-symbols-outlined">my_location</span></button></div>
                            </div>
                             <div>
                                <label for="height" class="block text-sm font-medium text-white/80 mb-2">Approx. Height (Optional)</label>
                                <div class="relative group"><span class="material-symbols-outlined input-icon">height</span><input type="text" id="height" name="height" class="form-input-icon" placeholder="e.g., '3 ft' or '1 meter'"></div>
                            </div>
                            <div>
                                <label for="watering" class="block text-sm font-medium text-white/80 mb-2">Watering Needs (Optional)</label>
                                <div class="relative group"><span class="material-symbols-outlined input-icon">water_drop</span><select id="watering" name="watering" class="form-input-icon"><option value="" disabled selected>Select frequency</option><option value="Daily">Daily</option><option value="Once every 2-3 days">Every 2-3 days</option><option value="Weekly">Weekly</option><option value="Rain-fed (Monsoon only)">Rain-fed</option></select></div>
                            </div>
                             <div>
                                <label for="notes" class="block text-sm font-medium text-white/80 mb-2">Notes (Optional)</label>
                                <div class="relative group"><textarea id="notes" name="notes" class="form-input-icon" rows="3" placeholder="Any details like 'Near water pump'"></textarea></div>
                            </div>
                        </div>

                        <div class="md:col-span-1 flex flex-col h-full">
                            <label class="block text-sm font-medium text-white/80 mb-2">Planting Photo <span class="text-red-500">*</span></label>
                            <div id="uploadBox" class="upload-box grow">
                                <div id="uploadPrompt" class="flex flex-col items-center">
                                    <span class="material-symbols-outlined text-5xl">cloud_upload</span>
                                    <p class="font-medium">Click to upload photo</p>
                                </div>
                                <img id="imagePreview" src="" alt="Tree planting preview" class="hidden w-full h-full object-cover rounded-lg">
                            </div>
                            <input type="file" id="fileInput" class="hidden" accept="image/png, image/jpeg, image/webp">
                        </div>


                        <div class="md:col-span-2 flex flex-col md:flex-row gap-4 items-center mt-6">
                            <button type="submit" class="w-full md:w-auto bg-primary hover:shadow-glow-primary text-background-dark text-base font-bold uppercase py-3 px-8 rounded-full transition-all duration-300">Review Details</button>
                            <a href="index.html" class="w-full md:w-auto text-center text-sm text-white/60 hover:text-white transition-colors">Cancel</a>
                        </div>
                    </form>

                    <div id="confirmationCard" class="hidden">
                         <h2 class="text-3xl font-bold font-heading text-white mb-6 text-center">Confirm Tree Details</h2>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-start">
                            <div class="md:col-span-1"><img id="confirmImage" src="" alt="Tree preview" class="w-full h-auto object-cover rounded-lg border border-white/10"></div>
                            <div class="md:col-span-2 space-y-4">
                                <div class="grid grid-cols-2 gap-4"><div><p class="detail-label">Species</p><p id="confirmSpecies" class="detail-value"></p></div><div><p class="detail-label">Age</p><p id="confirmAge" class="detail-value"></p></div><div><p class="detail-label">Planting Date</p><p id="confirmPlantingDate" class="detail-value"></p></div><div><p class="detail-label">Height</p><p id="confirmHeight" class="detail-value"></p></div></div>
                                <div><p class="detail-label">Location</p><p id="confirmLocation" class="detail-value"></p></div><div><p class="detail-label">Watering Needs</p><p id="confirmWatering" class="detail-value"></p></div><div><p class="detail-label">Notes</p><p id="confirmNotes" class="detail-value"></p></div>
                            </div>
                        </div>
                        <div class="flex flex-col md:flex-row gap-4 items-center mt-8 pt-6 border-t border-white/10">
                            <button type="button" id="confirmSaveBtn" class="w-full md:w-auto bg-primary hover:shadow-glow-primary text-background-dark text-base font-bold uppercase py-3 px-8 rounded-full transition-all duration-300">Confirm & Save Tree</button>
                            <button type="button" id="editBtn" class="w-full md:w-auto text-center text-sm text-white/60 hover:text-white transition-colors">Go Back & Edit</button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <script type="module" src="firebase-init.js"></script>
    <script type="module" src="register-tree.js"></script>
</body>
</html>